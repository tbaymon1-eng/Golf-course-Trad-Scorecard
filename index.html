<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Cypresswood Scorecard</title>

  <style>
    :root{
      --paper:#e9e2d4;
      --ink:#111;
      --grid:#2b2b2b;
      --headerRow:#d8d1c3;
      --parRow:#a85a13;
      --parRowText:#fff;
      --hcpRow:#f2e6b9;
      --cellBg:#f8f4ea;
    }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--paper);
      color: var(--ink);
    }

    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 10px 10px 24px;
    }

    .card{
      background: #efe7d7;
      border: 3px solid #7a4a0b;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 8px 22px rgba(0,0,0,.18);
    }

    .header-img{
      width: 100%;
      display:block;
    }

    .table-shell{
      background: #efe7d7;
      padding: 10px;
    }

    .hint{
      padding: 10px 12px 0;
      font-size: 13px;
      opacity:.85;
    }

    .scroll-x{
  overflow-x: auto;
  overflow-y: visible;          /* important */
  -webkit-overflow-scrolling: touch;
  border: 2px solid #7a4a0b;
  border-radius: 10px;
  background: rgba(255,255,255,.12);
  margin-top: 10px;
}

      border: 2px solid #7a4a0b;
      border-radius: 10px;
      background: rgba(255,255,255,.12);
      margin-top: 10px;
    }

    table{
      border-collapse: collapse;
      min-width: 1120px; /* includes extra columns (INITIAL/Hcp/Net) */
      width: 100%;
    }

    th, td{
      border: 2px solid var(--grid);
      padding: 0;
      height: 38px;
      background: var(--cellBg);
    }

    .label{
      width: 140px;
      font-weight: 900;
      padding: 0 10px;
      text-align: left;
      background: #e1d8c8;
      white-space: nowrap;
    }

    thead th{
      position: sticky;
      top: 0;
      z-index: 5;
      background: var(--headerRow);
      font-weight: 900;
      height: 42px;
    }

    .hole{ width: 44px; text-align:center; font-weight: 900; }
    .sum{ width: 60px; text-align:center; font-weight: 900; }

    .yard{
      text-align:center;
      font-weight: 900;
      font-size: 16px;
    }

    /* Yardage row colors (we can fine-tune to match print perfectly) */
    .row-black td{ background:#0d2a55; color:#fff; }
    .row-blue  td{ background:#1f5ea8; color:#fff; }
    .row-silver td{ background:#cfcfcf; color:#111; }
    .row-copper td{ background:#a85a13; color:#fff; }
.row-white td{
  background:#f7f7f7;  /* white-ish like the card */
  color:#111;
}
.row-white .label{
  background:#f0f0f0;
  color:#111;
}

.row-silver td{
  background:#cfcfcf;  /* silver */
  color:#111;
}
.row-silver .label{
  background:#bdbdbd;
  color:#111;
}

    .row-black .label{ background:#0b2246; color:#fff; }
    .row-blue  .label{ background:#174c89; color:#fff; }
    .row-silver .label{ background:#bdbdbd; color:#111; }
    .row-copper .label{ background:#8f4b10; color:#fff; }

    .row-par td{ background: var(--parRow); color: var(--parRowText); }
    .row-par .label{ background: #8f4b10; color:#fff; }

    .row-hcp td{ background: var(--hcpRow); color:#111; }
    .row-hcp .label{ background: #e9dcaa; }

    /* Inputs that look printed into the box */
    .score-input{
      width: 100%;
      height: 100%;
      border: 0;
      outline: none;
      background: transparent;
      text-align: center;
      font-weight: 950;
      font-size: 18px;
      color: #111;
      -webkit-appearance: none;
      appearance: none;
      caret-color: transparent;
    }
    .score-input:focus{
      outline: none;
      box-shadow: inset 0 0 0 9999px rgba(0,0,0,.06);
    }

    .player-name{
      width: 100%;
      height: 100%;
      border: 0;
      outline: none;
      background: transparent;
      font-weight: 950;
      padding: 0 10px;
      font-size: 16px;
    }
    .player-name:focus{
      box-shadow: inset 0 0 0 9999px rgba(0,0,0,.06);
    }

    .total{
      text-align:center;
      font-weight: 1000;
      font-size: 18px;
      background:#f1eadb;
    }

    .actions{
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      padding: 12px 10px 14px;
      background: #efe7d7;
    }
    button{
      border: 2px solid #7a4a0b;
      background: #e7ddcb;
      border-radius: 10px;
      padding: 12px 10px;
      font-weight: 900;
      font-size: 16px;
    }
    button:active{ transform: translateY(1px); }
    .danger{
      background:#b6422d;
      color:#fff;
      border-color:#7a2b20;
      grid-column: 1 / -1;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card" id="card">

      <!-- MUST match your repo file exactly -->
      <img class="header-img" src="./assets/cypresswood_header.png" alt="Cypresswood Header" />

      <div class="table-shell">
        <div class="hint">Swipe left/right. Tap a box to type. Out/In/Tot auto-calc.</div>

        <div class="scroll-x">
          <table id="scoreTable">
            <thead>
              <tr id="hdrRow"></tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>

      <div class="actions">
        <button id="saveImg">Save as Image</button>
        <button id="downloadPdf" disabled>Download PDF (next)</button>
        <button id="share">Share</button>
        <button class="danger" id="clear">Clear Card</button>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    // ---------- DATA (EXACT TO YOUR CARD) ----------
// ---------- DATA (EXACT TO THE IMAGE YOU POSTED) ----------
const holesFront = [1,2,3,4,5,6,7,8,9];
const holesBack  = [10,11,12,13,14,15,16,17,18];

const tees = {
  black: {
    label:"Black Tees",
    front:[465,384,203,448,606,376,528,196,453],
    out:3657,
    back:[405,256,545,464,185,394,472,318,546],
    inn:3563,
    tot:7220
  },
  blue: {
    label:"Blue Tees",
    front:[373,356,195,422,565,343,508,169,409],
    out:3340,
    back:[370,211,518,423,169,357,439,291,520],
    inn:3298,
    tot:6638
  },
  white: {
    label:"White Tees",
    front:[348,328,169,398,547,311,482,169,394],
    out:3146,
    back:[348,187,468,395,151,328,378,265,496],
    inn:3016,
    tot:6162
  },
  silver: {
    label:"Silver Tees",
    front:[348,328,129,528,461,277,482,107,305],
    out:2765,
    back:[315,153,413,348,151,328,318,215,435],
    inn:2676,
    tot:5441
  },
  copper: {
    label:"Copper Tees",
    front:[296,287,117,242,411,277,388,107,284],
    out:2409,
    back:[315,131,400,318,75,245,291,215,386],
    inn:2376,
    tot:4785
  }
};

// Par row (matches the image: Out 36 / In 36 / Total 72)
const parFront = [4,4,3,4,5,4,5,3,4]; // = 36
const parBack  = [4,3,5,4,3,4,4,4,5]; // = 36

// Handicap row (matches the image)
const hcpFront = [7,17,11,1,3,13,9,15,5];
const hcpBack  = [14,8,10,6,18,12,2,16,4];

const players = 6;


    function sum(arr){ return arr.reduce((a,b)=>a+(Number(b)||0),0); }
    function yardCell(v){ return `<td class="yard">${v ?? ""}</td>`; }

    function buildHeader(){
      const hdr = document.getElementById("hdrRow");
      hdr.innerHTML = `
        <th class="label">Hole</th>
        ${holesFront.map(h=>`<th class="hole">${h}</th>`).join("")}
        <th class="sum">Out</th>
        <th class="sum">I<br>N<br>I<br>T</th>
        ${holesBack.map(h=>`<th class="hole">${h}</th>`).join("")}
        <th class="sum">In</th>
        <th class="sum">Tot</th>
        <th class="sum">Hcp</th>
        <th class="sum">Net</th>
      `;
    }

    function buildYardageRow(key, cssClass){
      const t = tees[key];
      const tr = document.createElement("tr");
      tr.className = cssClass;
      tr.innerHTML = `
        <td class="label">${t.label}</td>
        ${t.front.map(n=>yardCell(n)).join("")}
        ${yardCell(t.out)}
        ${yardCell("")}
        ${t.back.map(n=>yardCell(n)).join("")}
        ${yardCell(t.inn)}
        ${yardCell(t.tot)}
        ${yardCell("")}
        ${yardCell("")}
      `;
      return tr;
    }

    function buildBlankRow(){
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="label"></td>
        ${"<td></td>".repeat(9)}
        <td></td>
        <td></td>
        ${"<td></td>".repeat(9)}
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      `;
      return tr;
    }

    function buildParRow(){
      const out = sum(parFront), inn = sum(parBack), tot = out+inn;
      const tr = document.createElement("tr");
      tr.className = "row-par";
      tr.innerHTML = `
        <td class="label">Par:</td>
        ${parFront.map(n=>yardCell(n)).join("")}
        ${yardCell(out)}
        ${yardCell("")}
        ${parBack.map(n=>yardCell(n)).join("")}
        ${yardCell(inn)}
        ${yardCell(tot)}
        ${yardCell("")}
        ${yardCell("")}
      `;
      return tr;
    }

    function buildHcpRow(){
      const tr = document.createElement("tr");
      tr.className = "row-hcp";
      tr.innerHTML = `
        <td class="label">Handicap</td>
        ${hcpFront.map(n=>yardCell(n)).join("")}
        ${yardCell("")}
        ${yardCell("")}
        ${hcpBack.map(n=>yardCell(n)).join("")}
        ${yardCell("")}
        ${yardCell("")}
        ${yardCell("")}
        ${yardCell("")}
      `;
      return tr;
    }

    function cellInput(playerIdx, holeNum){
      const id = `p${playerIdx}_h${holeNum}`;
      return `
        <td>
          <input
            id="${id}"
            class="score-input"
            inputmode="numeric"
            pattern="[0-9]*"
            maxlength="2"
            autocomplete="off"
            aria-label="Player ${playerIdx+1} hole ${holeNum}"
          />
        </td>
      `;
    }

    function buildPlayerRow(i){
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="label"><input class="player-name" placeholder="Player ${i+1}" /></td>
        ${holesFront.map(h=>cellInput(i,h)).join("")}
        <td class="total" data-out="${i}">0</td>
        <td></td>
        ${holesBack.map(h=>cellInput(i,h)).join("")}
        <td class="total" data-in="${i}">0</td>
        <td class="total" data-tot="${i}">0</td>
        <td></td>
        <td></td>
      `;
      return tr;
    }

    function recalcPlayer(i){
      let out=0, inn=0;
      for (const h of holesFront){
        out += Number(document.getElementById(`p${i}_h${h}`).value || 0);
      }
      for (const h of holesBack){
        inn += Number(document.getElementById(`p${i}_h${h}`).value || 0);
      }
      const tot = out + inn;
      document.querySelector(`[data-out="${i}"]`).textContent = out;
      document.querySelector(`[data-in="${i}"]`).textContent = inn;
      document.querySelector(`[data-tot="${i}"]`).textContent = tot;
    }

    function wireInputs(){
      for (let i=0;i<players;i++){
        for (let h=1;h<=18;h++){
          const el = document.getElementById(`p${i}_h${h}`);
          el.addEventListener("input", () => {
            el.value = (el.value || "").replace(/[^\d]/g,"").slice(0,2);
            recalcPlayer(i);
          });
        }
        recalcPlayer(i);
      }
    }

    function build(){
      buildHeader();
     tbody.appendChild(buildYardageRow("black","row-black"));
tbody.appendChild(buildYardageRow("blue","row-blue"));
tbody.appendChild(buildYardageRow("white","row-silver"));  // reuse silver styling (gray) for White row, or create a new class

    
      tbody.appendChild(buildParRow());
      tbody.appendChild(buildHcpRow());
      for (let i=0;i<players;i++) tbody.appendChild(buildPlayerRow(i));
      tbody.appendChild(buildYardageRow("copper","row-copper"));
      wireInputs();
    }

    build();

    // SAVE
    document.getElementById("saveImg").addEventListener("click", async () => {
      const node = document.getElementById("card");
      const canvas = await html2canvas(node, { scale: 2, backgroundColor: null });
      const dataUrl = canvas.toDataURL("image/png");
      const w = window.open();
      w.document.write(`<img src="${dataUrl}" style="width:100%;height:auto" />`);
    });

    // SHARE
    document.getElementById("share").addEventListener("click", async () => {
      try{
        const node = document.getElementById("card");
        const canvas = await html2canvas(node, { scale: 2, backgroundColor: null });
        const blob = await new Promise(res => canvas.toBlob(res, "image/png"));
        const file = new File([blob], "cypresswood-scorecard.png", { type:"image/png" });

        if (navigator.canShare && navigator.canShare({ files:[file] })){
          await navigator.share({ files:[file], title:"Scorecard" });
        } else {
          alert("Sharing not supported here. Use Save as Image then share from Photos.");
        }
      } catch(e){
        alert("Share failed. Use Save as Image.");
      }
    });

    // CLEAR
    document.getElementById("clear").addEventListener("click", () => {
      if(!confirm("Clear all scores?")) return;
      document.querySelectorAll(".score-input").forEach(i => i.value="");
      for (let i=0;i<players;i++) recalcPlayer(i);
    });
  </script>
</body>
</html>
